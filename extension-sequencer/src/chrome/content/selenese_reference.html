<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- When I just used HMTL 5 !DOCTYPE html at the top, Firefox 37 didn't process the file; instead, it showed element content, including JS code. -->
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Selenese reference for an SeLite add-on</title>
        <script type="text/javascript">
            //<![CDATA[
            "use strict";
            // Based on see http://www.w3schools.com/xsl/xsl_client.asp. See that page for IE.
            /** @param {string} filename
             *  @param {function(xml)} handler
             * */
            function loadXMLDoc( filename, handler )
            {
              var xhttp = new XMLHttpRequest();
              xhttp.open("GET", filename, true/*async*/);
              xhttp.onload= function onload() {
                  if( this.readyState===4 && this.status===200 ) {
                    handler( this.responseXML );
                  }
              };
              xhttp.send(null);
            }

            function displayResult()
            {
              var bodyElement= document.getElementById("body");
              if( window.location.search ) {
                  loadXMLDoc( (''+window.location.search).substring(1), function handleXML(xml) {
                    loadXMLDoc( "selenese_reference_to_html.xsl", function handleXSL(xsl) {
                        var xsltProcessor = new XSLTProcessor();
                        xsltProcessor.importStylesheet(xsl);
                        var resultDocument = xsltProcessor.transformToFragment(xml, document);
                        bodyElement.appendChild(resultDocument);
                    });
                  });
              }
              else {
                  bodyElement.appendChild( document.createTextNode('Please invoke with ?path/to/file.xml') );
              }
            }
            //]]>
        </script>
    </head>
    <body onload="displayResult();" id="body">
    </body>
</html>