<html>
<head>
  <meta charset="utf-8"></meta>
  <title>Simple</title>
  <!-- As of March 2016, PURE is the easiest engine listed on https://developer.mozilla.org/en-US/docs/JavaScript_templates -->
  <script type="text/javascript" src="https://rawgit.com/peter-kehl/pure/master/libs/pure.js"></script>
  <script type="text/javascript" src="simple.js"></script>
  <link rel="stylesheet" type="text/css" href="style.css" />
  <!--
Don't use raw.githubusercontent.com with MS IE 10, since it fails with SEC7112: Script from https://raw.githubusercontent.com/peter-kehl/pure/master/libs/pure.js was blocked due to mime type mismatch 
 -->
  <script type="text/javascript">
      //<![CDATA[
      "use strict";
      var config= { // This has to reflect config object passed to editor.openPreview( url, data, config ) in Selenium IDE.
          dataParameterName: 'seLitePreviewData',
          inHash: true,
          base64: true
      };
      
      var selenium;
      function seLitePreviewConnect( connect ) {
          alert('connect');
          selenium= connect.selenium;
      }
      
       document.onreadystatechange= function() {
          if (document.readyState==="complete") {
            
            var encodedJSON;
            if( config.inHash ) {
                if( location.hash.length>0 ) {
                    encodedJSON= location.hash.substring(1);
                }
            }
            else {
                if( location.search.length>0 ) {
                    var parameterPrefix= '&'+config.dataParameterName+'=';
                    var parameterStart= location.search.indexOf( parameterPrefix );
                    if( parameterStart<0 ) {
                        parameterPrefix= '?'+config.dataParameterName+'=';
                        parameterStart= location.search.indexOf( parameterPrefix );
                    }
                    if( parameterStart>=0 ) {
                        parameterStart+= parameterPrefix.length;
                        var parameterEnd= location.search.indexOf( '=', parameterStart );
                        encodedJSON= parameterEnd>0
                            ? location.search.substring( parameterStart, parameterEnd )
                            : location.search.substring( parameterStart );
                    }
                }
            }
            
            if( encodedJSON!==undefined ) {
                var json= config.base64
                    ? atob(encodedJSON)
                    : decodeURIComponent(encodedJSON);
                var data= JSON.parse(json);
                
                // The whole data will be an array of (primitive) strings. Use those strings for both text and URL of <a> elements:
                // See https://beebole.com/pure/
                var directive = {
                    'li':{
                        'data<-':{
                            'a': 'data',
                            'a@href': 'data'
                        }
                    }
                };
                // As per https://groups.google.com/forum/#!searchin/Pure-Unobtrusive-Rendering-Engine/pure$20without$20jquery/pure-unobtrusive-rendering-engine/Cmt1bqfsZLg/rhGP8ZqfliAJ
                $p('#results').render( data, directive );

                var results= document.getElementById('results');
            }
          }
        };
      //]]>
  </script>
</head>
<body>
    <a href="javascript:simple('Hi')">call a function from a local JS file</a><br/>
    <a href="javascript:callBackOutFlow( 'sayHello' )">call back Selenium</a>
    <br/>
    <div id="results">
        <ul class="image-decorated">
          <li>
              <a data-mood="happy" href=""></a>
          </li>
        </ul>
    </div>
</body>
</html>